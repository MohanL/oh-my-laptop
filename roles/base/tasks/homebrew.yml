---

- name: install some small, awesome packages to boost your life
  homebrew: pkg={{item}} state=present
  with_items:
    - ack
    - ag
    - byobu
    - cloc
    - cscope
    - htop-osx
    - nmap
    # - nmon   # not found in homebrew
    # - pinfo  # not found in homebrew
    - proxychains-ng
    - ranger
    - rlwrap
    - texinfo
    - wget

# shell
- name: ensure $HOME/.bashrc is present
  command: touch {{user_home}}/.bashrc

- name: ensure $HOME/.zshrc is present
  command: touch {{user_home}}/.zshrc

# http://stackoverflow.com/questions/7165108/in-osx-lion-lang-is-not-set-to-utf8-how-fix
# the default locale of OSX is "C", which is not proper in many cases. Better
# change it to UTF-8
- name: change locale from "C" to "en_US.UTF-8" in bash
  copy: src=bash_profile.osx.sh dest={{user_home}}/.profile

# zsh is not totally compatible with bash
- name: change locale from "C" to "en_US.UTF-8" in zsh
  copy: src=zsh_profile.osx.sh dest={{user_home}}/.zprofile

# zsh and oh-my-zsh
- name: install zsh
  homebrew: pkg={{item}} state=present
  with_items:
    - zsh
    - zsh-lovers

- name: clone oh-my-zsh repo
  git: repo=https://github.com/robbyrussell/oh-my-zsh.git
       dest={{user_home}}/.oh-my-zsh

- name: backup original zshrc
  copy: src={{user_home}}/.zshrc dest={{user_home}}/.zshrc.orig

- name: deploy .zshrc
  template: src=zshrc.sh dest={{user_home}}/.zshrc owner={{whoami}}

- name: set zsh as default user shell
  sudo: yes
  command: chsh -s /bin/zsh {{whoami}}

# add a tmux.conf
- name: settings tmux.conf
  copy: src=tmux.conf dest={{user_home}}/.tmux.conf
